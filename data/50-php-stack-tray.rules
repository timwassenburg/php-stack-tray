// Polkit rules for PHP Stack Tray
// Install to: /etc/polkit-1/rules.d/50-php-stack-tray.rules
//
// This caches authentication for the session so you only enter
// your password once instead of for every action.

polkit.addRule(function(action, subject) {
    // Systemd service management
    if (action.id == "org.freedesktop.systemd1.manage-units" ||
        action.id == "org.freedesktop.systemd1.manage-unit-files" ||
        action.id == "org.freedesktop.systemd1.reload-daemon") {

        if (subject.isInGroup("wheel") || subject.isInGroup("sudo")) {
            return polkit.Result.AUTH_ADMIN_KEEP;
        }
    }

    // pkexec commands (for vhosts, config files, etc.)
    if (action.id == "org.freedesktop.policykit.exec") {
        if (subject.isInGroup("wheel") || subject.isInGroup("sudo")) {
            return polkit.Result.AUTH_ADMIN_KEEP;
        }
    }
});
